# 网易云日语歌词注音器
----
## 简介
本项目尝试使用网易云复制导出的日文歌词和罗马音，生成markdown格式，标注片假名发音在汉字上方的效果

这样 ↓ 的效果：

>$\overset{し}{知}らない\overset{ふと}{人}と\overset{つな}{繋}がりあう\overset{じだい}{時代}に\overset{わたし}{私}はいる$
>在与陌生人紧密相连的时代里
>
>$\overset{はる}{春}\overset{かぜ}{風}\overset{め}{巡}る\overset{わだし}{私}の\overset{うた}{歌}が　\overset{だれ}{誰}かの\overset{かぜ}{風}になる$
>春风流转中我的歌声 又将成为谁的风？
>
>（歌曲：そしてはなになる - 花譜）

具体输出格式也可以在python脚本中修改，可参考脚本中注释。

### 优点
- 不使用其他外部库，不会出现分词发音问题（ふたり/ににん）
- 直接从网易云复制罗马音+翻译歌词导入即可使用

### 不足
- 现在
- 并且
- ~~初版弄完感觉这现在是个喂AI不花多大功夫的任务~~

----
## 使用方法
运行需要以目录下有 `input_jr.txt`（日文歌词及罗马音）和 `input_jc.txt` （日文歌词及翻译），具体格式来自网易云音乐直接复制歌词，可参考[示例文件](./example1/input_jr.txt)

而后运行此脚本`proc.py`即可
```sh
python ./proc.py
```

或者也可从命令行传入参数依次指定罗马音输入和翻译输入
```sh
python ./proc.py input_jr.txt input_jc.txt
```
最终脚本将会先输出直接匹配的歌词到目录下`output.md`中，

而后打开一个临时文件中存有初步的匹配结果，此时用户可手动修改汉字/片假名与平假名的匹配

保存并关闭临时文件后，脚本会将手动调整过匹配的歌词输出到目录下，`output.confirmed.md`中。

目前暂未实现指定输出文件名的功能。

### 关于手动编辑处理功能
打开的临时文件中初步匹配结果将以如下格式展示：
```
>汉字#
平假名发音
```
重新读入时，只有汉字行下一行的平假名会被视为此字发音，其余假名会被并入下一个词的发音中，也就是说只需要打一个回车就可以把音词分给下个词；如果去掉`#`符号则会将此字与之后一个字合并成一个词来注音。

如下：
>['笑', '顔']
>['えが', 'お']
>输出到临时文件
>```
>>笑#
>えが
>>顔#
>お
>```
>编辑后为
>```
>>笑#
>え
>が
>>顔#
>お
>```
>重新读入为
>['笑', '顔']
>['え', 'がお']

>['紅','葉']
>['もみ','じ']
>输出到临时文件
>```
>>紅#
>もみ
>>葉#
>じ
>```
>编辑后为
>```
>>紅
>もみ
>>葉#
>じ
>```
>重新读入为
>['紅葉', '']
>['もみじ', '']
>（空串是正常处理的一部分）

>['出', '来', '事']
>['でき', 'ご', 'と']
>输出到临时文件
>```
>>出#
>でき
>>来#
>ご
>>事#
>と
>```
>编辑后为
>```
>>出#
>で
>き
>>来#
>
>ご
>>事#
>と
>```
>重新读入为
>['出', '来', '事']
>['で', 'き', 'ごと']

此外还可以检查例子1（歌曲：優しいメモリ - 鹿乃）中[编辑后的临时文档](./example1/edited_temp.txt)

----
## 目前还处理不了的情况
- 长音符号（ニヤー有的写作nyaa）
- 过多标点格式不匹配（测试直接被太阳系disco干碎）（少部分也需要直接手改）
- 歌曲中包含无需处理部分（例如英文）
- 一个片假名初次匹配时错开了多个词的位置只能手动复制到下个词那里

----
## TODO（大概坑了）
- 处理以上提到的情况
- 运行脚本/exe打包以形成更规范化的命令行程序
- 更完备的使用说明
- 指定文件输出和几个开关
- 更多使用示例
  